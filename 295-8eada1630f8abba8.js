!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="db849674-93d7-4b07-aad2-2cfddd0a9473",e._sentryDebugIdIdentifier="sentry-dbid-db849674-93d7-4b07-aad2-2cfddd0a9473")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[295],{15685:function(e,t,n){"use strict";n.d(t,{q:function(){return f}});var r=n(37821),l=n(78781),i=n(27036),a=n(14233),s=n(90168),d=n(58078),o=n(17344),u=n(8862),c=n(87601),x=n(18151);function f(e){var t,n;let{user:u,following:c}=e,x=null!==(t=null==u?void 0:u.username)&&void 0!==t?t:void 0,f=null!==(n=null==u?void 0:u.avatar_url)&&void 0!==n?n:void 0,g=function(e){let t=(0,d.useContext)(o.Ti);if(t&&e)return t.username===e}(x),v=(0,s.usePathname)(),m=new URLSearchParams(location.search),p=(0,d.useCallback)((e,t)=>{let n=new URLSearchParams(m.toString());return n.set(e,t),n.toString()},[m]),y=(0,r.jsx)(i.default,{src:f||"/default_avatar.png",alt:null!=x?x:"",width:24,height:24,className:"w-6 h-6",onError:e=>{let t=e.target;"/default_avatar.png"!==t.src&&(t.src="/default_avatar.png")}});return x?(0,r.jsxs)(l.zs.Root,{children:[(0,r.jsx)(l.zs.Trigger,{children:(0,r.jsx)(a.default,{className:"rounded-full border border-gray-200 overflow-hidden\n            dark:border-neutral-700 aria-disabled:opacity-50 block\n            focus:outline-none focus:shadow-[0_0_0_2px_white]",href:"/@".concat(x),children:y})}),(0,r.jsx)(l.zs.Content,{sideOffset:5,children:(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4 min-w-28 text-sm",children:[(0,r.jsxs)(a.default,{href:"/@".concat(x),className:"flex flex-col items-center gap-4",children:[(0,r.jsx)(i.default,{className:"rounded-full",src:null!=f?f:"/default_avatar.png",alt:null!=x?x:"",width:48,height:48}),(0,r.jsxs)("div",{children:["@",x]})]}),g&&(0,r.jsx)(a.default,{href:v+"?"+p("settings","open"),className:"text-blue-500",children:"Settings"}),!g&&(0,r.jsx)(h,{username:x,following:c}),(0,r.jsx)("div",{className:"flex items-center gap-4"})]})})]}):(0,r.jsx)("div",{className:"rounded-full border border-gray-200 overflow-hidden dark:border-neutral-700 block focus:outline-none focus:shadow-[0_0_0_2px_white]",children:y})}function h(e){let{username:t,following:n}=e,i=function(){let e=(0,u.h)(),t=(0,c.useQueryClient)();return(0,x.useMutation)({mutationFn:async t=>{let n=await e.follows.followUser({params:{usernameOrId:t}});if(200!==n.status)throw n;return n.body.follow},onMutate:e=>{t.setQueryData(["user",e],e=>({...e,following:!0}))},onSuccess:e=>{t.invalidateQueries({queryKey:["user",e.user.username]})}})}(),a=function(){let e=(0,u.h)(),t=(0,c.useQueryClient)();return(0,x.useMutation)({mutationFn:async t=>{console.log("unfollowing user");let n=await e.follows.unfollowUser({params:{usernameOrId:t}});if(200!==n.status)throw n;return t},onMutate:e=>{t.setQueryData(["user",e],e=>({...e,following:!1}))},onSuccess:e=>{t.invalidateQueries({queryKey:["user",e]})}})}();return(0,r.jsx)(l.zx,{variant:n?"outline":"solid",onClick:()=>{n?a.mutateAsync(t):i.mutateAsync(t)},children:n?"Following":"Follow"})}},23133:function(e,t,n){"use strict";n.d(t,{ML:function(){return h},W7:function(){return c},Wh:function(){return f},n8:function(){return u},q4:function(){return x},xj:function(){return g}});var r=n(37821),l=n(14581),i=n(27624),a=n(22920),s=n(58078),d=n(56942),o=n(71786);let u=(0,s.createContext)(void 0),c=(0,s.createContext)(null);function x(e){let t=(0,s.useContext)(i.DE),n=(0,s.useContext)(o.Tl),[a,x]=(0,s.useState)(void 0),f=(0,s.useContext)(i.ze);return(0,s.useEffect)(()=>{(null==t?void 0:t.id)&&f&&x(f.siteContext?(0,l.cR)(t.id,f,{allowInfiniteContext:void 0!=(0,d.Pi)()}):(0,l.cR)(t.id,{...f,siteContext:(n||[]).slice(0,-1).map(e=>({id:e.id,pinned:!1}))},{allowInfiniteContext:void 0!=(0,d.Pi)()}))},[null==t?void 0:t.id,f]),(0,r.jsx)(c.Provider,{value:x,children:(0,r.jsx)(u.Provider,{value:a,children:e.children})})}function f(e){let t=(0,s.useContext)(c);return()=>{t((0,a.Uy)(t=>{(null==t?void 0:t.siteContext)&&(t.siteContext=t.siteContext.filter(t=>t.id!==e))}))}}function h(e){let t=(0,s.useContext)(c);return n=>{t((0,a.Uy)(t=>{if(!(null==t?void 0:t.siteContext))return;let r=t.siteContext.find(t=>t.id===e);r&&(r.pinned=n)}))}}function g(e){var t,n;let r=(0,s.useContext)(u);return null==r?void 0:null===(n=r.siteContext)||void 0===n?void 0:null===(t=n.find(t=>t.id===e))||void 0===t?void 0:t.pinned}},38295:function(e,t,n){"use strict";n.d(t,{E:function(){return M},Z:function(){return D}});var r=n(37821),l=n(53644);let i=l.z.object({type:l.z.literal("edit_element"),tagId:l.z.string(),prompt:l.z.string()}),a=l.z.object({version:l.z.literal(1),operations:l.z.array(i)});var s=n(77377),d=n(14581),o=n(75380),u=n(27950),c=n(56164),x=n(56942),f=n(39089),h=n(75005),g=n(87202),v=n(38204),m=n(4387),p=n(64816),y=n(83435),w=n(21725),j=n(78781),b=n(77362),N=n(22920),C=n(27036),k=n(14233),A=n(58078),_=n(74703),S=n(11696),I=n(15685),z=n(71786),E=n(23133);function D(){let e=(0,A.useContext)(E.n8),t=null==e?void 0:e.siteContext,n=(0,A.useContext)(E.W7);return(0,g.IJ)({onDragEnd:function(e){var r,l,i,a,s,d;let{active:o,over:u}=e;if(!o||!u||!t)return;let c=null===(l=o.data)||void 0===l?void 0:null===(r=l.current)||void 0===r?void 0:r.id,x=null===(a=u.data)||void 0===a?void 0:null===(i=a.current)||void 0===i?void 0:i.id,f=null===(d=o.data)||void 0===d?void 0:null===(s=d.current)||void 0===s?void 0:s.source;if(c&&x&&f){if("bookmarkList"===f||"likeList"===f)n((0,N.Uy)(e=>{if(!e||(e.siteContext||(e.siteContext=[]),-1!==e.siteContext.findIndex(e=>e.id===c)))return;let t=e.siteContext.map(e=>e.id).indexOf(x);o.rect.current.translated&&o.rect.current.translated.top+o.rect.current.translated.height/2<u.rect.top+u.rect.height/2&&(t+=1),e.siteContext.splice(t,0,{id:c,pinned:!1})}));else if(c!==x){let e=t.findIndex(e=>e.id===c),r=t.findIndex(e=>e.id===x),l=(0,v.Rp)(t,e,r);n((0,N.Uy)(e=>{e&&(e.siteContext=l)}))}}}}),(0,r.jsx)("div",{className:"flex flex-col flex-gap-6",children:(0,r.jsxs)("div",{className:"group flex flex-0 py-2 rounded-lg flex-col-reverse relative z-0 gap-4",children:[null==t&&(0,r.jsx)("div",{className:"text-xs text-gray-400 px-2 py-2",children:"Loading..."}),t&&(0,r.jsxs)(v.Fo,{items:t,strategy:v.qw,children:[null==t?void 0:t.map((e,n)=>(0,r.jsx)(M,{siteContextItem:e,index:t.length-n-1},e.id)),0===t.length&&(0,r.jsx)("div",{className:"text-xs text-gray-400 px-2 py-2",children:"No pages in context"})]})]})})}function M(e){let t=(0,z.Wo)(),n=function(e){let t=(0,h.$)();return(0,b.useQuery)({queryKey:["historyDetails",e],queryFn:async()=>{if((0,o.kM)(e))return(0,s.D2)({messages:o.vg[e],debug:!0})[0];let n=await t.from("sites").select("id,prompt,content").eq("id",e).single();if(!n.data)throw Error("No data found");let r=n.data;if(!r.content)throw Error("No content found");return(0,s.KI)({id:r.id,prompt:r.prompt,content:r.content})}})}(e.siteContextItem.id),{attributes:l,listeners:i,setNodeRef:a,isDragging:u,transform:c,transition:f}=(0,v.nB)({id:e.siteContextItem.id,data:{id:e.siteContextItem.id,source:"siteContext"}}),g={transform:m.ux.Transform.toString(c),transition:f},p=e.index&&!(0,x.Pi)()&&e.index>=d.wn,y=(0,r.jsx)("div",{...l,...i,className:"flex flex-col w-full items-center cursor-grab",children:(0,r.jsxs)("div",{className:"flex flex-col gap-1 py-1 pb-2 w-10",children:[(0,r.jsx)("div",{className:"h-[1px] bg-gray-300 dark:bg-neutral-500"}),(0,r.jsx)("div",{className:"h-[1px] bg-gray-300 dark:bg-neutral-500"})]})});return(0,r.jsx)("div",{ref:a,style:g,className:"flex gap-4 bg-gray-100 dark:bg-neutral-800 rounded-lg ".concat(p?"opacity-60":""),children:n.data&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Q,{historyState:n.data,currentPage:n.data.id===(null==t?void 0:t.id)}),(0,r.jsx)(F,{historyState:n.data,currentPage:n.data.id===(null==t?void 0:t.id),handle:y})]})})}function Q(e){let[t,n]=(0,A.useState)(!1),{profile:l,following:i}=(0,f.i)(e.historyState.id),a=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"absolute inset-0 gray-100 flex items-center justify-center aria-hidden:hidden bg-gray-200 rounded-lg","aria-hidden":t,children:(0,r.jsx)(w.Z,{className:"w-12 h-12 text-gray-400 animate-pulse"})}),(0,r.jsx)(C.default,{placeholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",className:"object-cover w-full h-full rounded-lg aria-hidden:hidden","aria-hidden":!t,src:"https://images.websim.ai/v1/site/".concat(e.historyState.id,"/600"),alt:"Screenshot of the page",loading:"eager",onLoad:()=>{n(!0)},width:96,height:96})]});return(0,o.kM)(e.historyState.id)&&(a=(0,r.jsx)("div",{className:"w-[96px] h-[96px] flex items-center justify-center bg-white dark:bg-neutral-900 rounded-lg",children:(0,r.jsx)(c.T,{className:""})})),(0,r.jsxs)(R,{className:"aria-selected:scale-[1.1] hover:scale-[1.1] z-10 transition-all duration-200 ease-in-out","aria-selected":e.currentPage,children:[(0,r.jsx)(k.default,{href:(0,S.l)(t=>{t.pathname=(0,S.z)(e.historyState.id)}),children:a}),(0,r.jsx)("div",{className:"absolute -bottom-1 -left-1",children:!(0,o.kM)(e.historyState.id)&&(0,r.jsx)(I.q,{user:l,following:i})})]})}function q(e){let t=(0,E.ML)(e.id),n=(0,E.xj)(e.id);return(0,r.jsx)("button",{className:"text-xs p-1 bg-white rounded-full dark:bg-neutral-700\n        ".concat(n?"opacity-100":"opacity-20","\n      "),type:"button",onClick:e=>{e.preventDefault(),t(!n)},children:(0,r.jsx)(P,{className:"w-4 h-4 text-gray-800 dark:text-white pointer-events-none"})})}n(99578);let P=e=>(0,r.jsx)("svg",{width:"800px",height:"800px",className:e.className,version:"1.1",id:"Capa_1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 490.125 490.125",children:(0,r.jsx)("g",{children:(0,r.jsx)("g",{children:(0,r.jsx)("g",{children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M300.625,5.025c-6.7-6.7-17.6-6.7-24.3,0l-72.6,72.6c-6.7,6.7-6.7,17.6,0,24.3l16.3,16.3l-40.3,40.3l-63.5-7 c-3-0.3-6-0.5-8.9-0.5c-21.7,0-42.2,8.5-57.5,23.8l-20.8,20.8c-6.7,6.7-6.7,17.6,0,24.3l108.5,108.5l-132.4,132.4 c-6.7,6.7-6.7,17.6,0,24.3c3.3,3.3,7.7,5,12.1,5s8.8-1.7,12.1-5l132.5-132.5l108.5,108.5c3.3,3.3,7.7,5,12.1,5s8.8-1.7,12.1-5 l20.8-20.8c17.6-17.6,26.1-41.8,23.3-66.4l-7-63.5l40.3-40.3l16.2,16.2c6.7,6.7,17.6,6.7,24.3,0l72.6-72.6c3.2-3.2,5-7.6,5-12.1 s-1.8-8.9-5-12.1L300.625,5.025z M400.425,250.025l-16.2-16.3c-6.4-6.4-17.8-6.4-24.3,0l-58.2,58.3c-3.7,3.7-5.5,8.8-4.9,14 l7.9,71.6c1.6,14.3-3.3,28.3-13.5,38.4l-8.7,8.7l-217.1-217.1l8.7-8.6c10.1-10.1,24.2-15,38.4-13.5l71.7,7.9 c5.2,0.6,10.3-1.2,14-4.9l58.2-58.2c6.7-6.7,6.7-17.6,0-24.3l-16.3-16.3l48.3-48.3l160.3,160.3L400.425,250.025z"})})})})});function U(e){let t=(0,E.Wh)(e.id);return(0,r.jsx)("button",{className:"text-xs p-1 bg-white rounded-full dark:bg-neutral-700",type:"button",onClick:e=>{e.preventDefault(),t()},children:(0,r.jsx)(p.Z,{className:"w-4 h-4 text-gray-800 dark:text-white pointer-events-none"})})}function F(e){var t;let n;let l=null===(t=e.historyState.debug)||void 0===t?void 0:t.messages.find(e=>"user"===e.role),i=l?(0,u.QE)(l.content):null;if(i){n=(0,r.jsx)("span",{children:i});let e=function(e){let t=/!edit\s+(.+)/.exec(e);if(!t)return null;try{return a.parse(JSON.parse(t[1]))}catch(e){return console.log("invalid edit payload",e),null}}(i);e&&(n=(0,r.jsx)("div",{children:e.operations.map(e=>(0,r.jsxs)("div",{className:"flex flex-row gap-1",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-neutral-400",children:"Edit"}),(0,r.jsx)(y.Z,{className:"w-4 h-4 text-gray-500 dark:text-neutral-400"}),(0,r.jsx)("div",{children:e.prompt})]},e.tagId))}))}else n=null;let d=(0,s.l9)(e.historyState.url);return(0,r.jsxs)("div",{className:"group flex flex-row w-full py-2 gap-2 px-2 rounded-lg relative z-0 gap-4 text-xs flex items-start justify-stretch w-full text-left",children:[(0,r.jsxs)("div",{className:"text-black whitespace-pre-wrap flex flex-col items-start flex-1 dark:text-white",style:{overflowWrap:"anywhere"},children:[e.handle,(0,r.jsx)(L,{children:(0,r.jsxs)("div",{className:"flex flex-col",children:[i!==d&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-neutral-400 whitespace-pre-wrap break-all max-h-24",children:d}),(0,r.jsx)("div",{className:"h-[1rem]"})]}),(0,r.jsx)("span",{children:n})]})})]}),(0,r.jsx)("div",{className:"absolute top-8 -right-1",children:(0,r.jsx)(q,{id:e.historyState.id})}),(0,r.jsx)("div",{className:"absolute -top-1 -right-1",children:(0,r.jsx)(U,{id:e.historyState.id})})]})}function L(e){let{ref:t,height:n}=(0,_.Z)(),l=n&&n>64,[i,a]=(0,A.useState)(!1);return(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsx)("div",{className:"relative\n      ".concat(e.className||""," ").concat(l?i?"":"overflow-y-clip max-h-12":"","\n      "),children:(0,r.jsx)("div",{ref:t,children:e.children})}),l&&(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)("button",{className:"text-xs text-gray-500 dark:text-neutral-200 hover:opacity-80 flex flex-row items-center gap-1",onClick:e=>{e.preventDefault(),a(!i)},children:(0,r.jsx)(j.v4,{className:"w-3 h-3 ".concat(i?"rotate-180":"")})})})]})}function R(e){return(0,r.jsx)("div",{...e,className:"relative h-24 w-24 min-w-24\n      hover:shadow-lg\n      ring-1 ring-gray-200/20 dark:ring-neutral-50/10\n      flex-0\n      shadow-md rounded-lg ".concat(e.className||""),children:e.children})}},39089:function(e,t,n){"use strict";n.d(t,{$:function(){return o},i:function(){return u}});var r=n(75380),l=n(75005),i=n(87601),a=n(77362),s=n(30675);function d(e){return["site",e,"profile_for_site"]}function o(){let e=(0,i.useQueryClient)();return(t,n)=>{e.setQueryData(d(t),n)}}function u(e){var t,n,i;let o=(0,l.$)(),u=null===(t=(0,a.useQuery)({queryKey:d(e),queryFn:async()=>{var t;let n=await o.from("sites").select("...profile!user_id(username)").eq("id",e).single();if(n.error)throw Error(n.error.message);return{username:null!==(t=n.data.username)&&void 0!==t?t:""}},enabled:!!e&&!(0,r.kM)(e)}).data)||void 0===t?void 0:t.username,c=(0,s.a)(u);return{profile:null===(n=c.data)||void 0===n?void 0:n.user,following:(null===(i=c.data)||void 0===i?void 0:i.followed_at)!==void 0}}},99578:function(){}}]);